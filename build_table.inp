clear

function matrix compute_block(const series ret)
    matrix M = {0,0,0,0}
    M[1] = mean(ret)
    M[2] = sd(ret)/sqrt($nobs)
    M[3] = M[1]/M[2]
    M[4] = pvalue(t, $nobs - 1, abs(M[3]))
    return M
end function

open "D:\DocumentiD\gretlD\results_candlesticks.csv"

matrix res = {}
matrix row_res = {}
loop t_r = 1 .. 3
    loop patt = 1 .. 7
        loop q_r = 1 .. 4
            loop days = 1 .. 6
                smpl Trend_range == t_r --restrict 
                smpl Pattern == patt --restrict 
                smpl Quantile_range == q_r --restrict 
                smpl Days_return == days --restrict                 
                row_res = row_res ~ compute_block(Return_on_day) 
                smpl full
            endloop
            res = res | row_res
            row_res = {}
        endloop
    endloop
endloop

print res